# ainput_draft

这是项目fullstack草稿

以微软拼音输入法为例, 在使用这个输入法的时候输入的字符是拼音字母, 然后用数字键选择候选词
我需要实现一个输入法, 提供ai候选, ai依据当前聚焦的窗口和输入框, 用户习惯, 窗口上下文, 输入历史, 提供一系列的ai候选, 甚至语言也由ai决定
1. 输入法应当有一个悬浮组件, 一直展示候选词, 随着聚焦的窗口和输入框改变, 候选词也随之改变
1. 输入法可以加装插件, 比如拼音输入插件, 可以把拼音候选词也加到候选词列表中

---

## 详细开发计划（与 Cursor 协作）

### 阶段一：基础能力搭建

1. **需求梳理与技术选型**
   - 明确 MVP 目标：模拟输入法体验，用户输入内容先进入输入框，选择候选词后自动删除原内容并插入候选。
   - 技术栈：Rust + windows-rs（系统交互）、Tauri/react UI）、reqwest/tokio（AI 通信）、SQLite（历史管理）。

2. **项目初始化**
   - 使用 Cargo 新建 Rust 项目，按模块拆分（windows_interop.rs、candidate_ui.rs、ai_client.rs、input_history.rs、config.rs、main.rs）。
   - 配置 Tauri/react 前端环境，确保可创建悬浮窗。
   - 版本要求: windows-rs 0.61, tauri 2.5.0

---

### 阶段二：核心功能开发

1. **Windows 交互模块**
   - 用 windows-rs 获取当前聚焦窗口、输入框内容。
   - 监听输入事件，捕获用户输入内容。
   - 能够定位并操作输入框内容（如删除、插入文本）。

2. **候选词悬浮组件**
   - 用 Tauri/egui 实现悬浮窗，实时展示候选词（支持 mock 数据）。
   - 支持快捷键/鼠标选择候选词，触发插入操作。

3. **AI 候选模块**
   - 实现 ai_client.rs，支持配置 API 地址，异步请求候选词。
   - 支持 mock 数据和真实 API 切换，便于开发调试。

4. **输入历史管理**
   - 用 SQLite 或本地文件记录输入历史。
   - 提供历史数据查询接口，辅助 AI 个性化推荐。

5. **配置管理**
   - 支持热加载配置（API 地址、UI 样式等）。
   - 提供简单的配置文件编辑入口。

---

### 阶段三：功能集成与体验优化

1. **主循环与事件驱动**
   - main.rs 负责初始化各模块，监听输入和窗口变化，驱动 UI 和 AI 更新。
   - 保证各模块解耦、接口清晰，便于后续扩展。

2. **模拟输入法体验**
   - 用户输入内容后，候选词悬浮窗弹出。
   - 用户选择候选词时，自动删除输入框原内容并插入候选词，模拟“预编辑”体验。
   - 支持撤销、重做等基础编辑操作。

3. **插件机制预留**
   - 设计插件接口，便于后续集成拼音等输入插件。
   - 插件可向候选词列表追加自定义候选。

---

### 阶段四：测试、文档与协作

1. **功能测试**
   - 编写基础单元测试和集成测试，确保各模块稳定。
   - 在常见输入框、编辑器中测试兼容性。

2. **协作文档**
   - 在 draft.md 持续记录开发进度、遇到的问题与解决方案。
   - 明确每个阶段的负责人、时间节点和交付标准。

3. **后续计划**
   - 根据 MVP 反馈，评估是否深入 TSF/IME 开发，实现真正的输入法“预编辑”体验。
   - 持续优化 UI/UX，完善插件和配置生态。

---

### 里程碑与时间安排（建议）

- 阶段一：1-2 天
- 阶段二：5-7 天
- 阶段三：3-5 天
- 阶段四：持续进行

---

> 本开发计划为 MVP 版本，后续可根据实际进展和需求灵活调整。建议每完成一个阶段及时同步进度，便于与 Cursor 高效协作。

### todo
- [ ] 隐私数据过滤
- [ ] 特殊app调优
   - [ ] XLMAIN, 50033 -> excel
   - [ ] PPTFrameClass, 50033 -> ppt